
let data = {
	"items": {
		"item": [{
				"id": "0001",
				"type": "donut",
				"name": "Hell Cake",
				"ppu": 0.55,
				"batters": {
					"batter": [{
							"id": "1001",
							"type": "Regular"
						},
						{
							"id": "1002",
							"type": "Chocolate"
						},
						{
							"id": "1003",
							"type": "Blueberry"
						},
						{
							"id": "1004",
							"type": "Devil's Food"
						}
					]
				},
				"topping": [{
						"id": "5001",
						"type": "None"
					},
					{
						"id": "5002",
						"type": "Glazed"
					},
					{
						"id": "5005",
						"type": "Sugar"
					},
					{
						"id": "5007",
						"type": "Powdered Sugar"
					},
					{
						"id": "5006",
						"type": "Chocolate with Sprinkles"
					},
					{
						"id": "5003",
						"type": "Chocolate"
					},
					{
						"id": "5004",
						"type": "Maple"
					}
				],
				"nutrition_facts": {
					"nutrition": {
						"calories": 345,
						"fat": {
							"daily_value": "8%",
							"fat_type": {
								"saturated": "5.5g",
								"trans": "1.3g"
							}
						},
						"cholesterol": {
							"daily_value": "12%",
							"amount": "12mg"
						},
						"sodium": {
							"daily_value": "15%",
							"amount": "280mg"
						},
						"carbohydrate": {
							"daily_value": "6%",
							"carbs_detail": {
								"amount": "12 g",
								"type": {
									"fibre": "1g",
									"sugars": "25g"
								}
							}
						},
						"proteine": "11g",
						"vitamines": [{
								"type": "Vitamin A",
								"percent": "0%"
							},
							{
								"type": "Vitamin C",
								"percent": "0%"
							},
							{
								"type": "Calcium",
								"percent": "2%"
							},
							{
								"type": "Iron",
								"percent": "8%"
							}
						]
					}
				}
			},
			{
				"id": "0002",
				"type": "donut",
				"name": "Funny Wizard",
				"ppu": 0.54,
				"batters": {
					"batter": [{
							"id": "1001",
							"type": "Regular"
						},
						{
							"id": "1002",
							"type": "Chocolate"
						},
						{
							"id": "1003",
							"type": "Blueberry"
						},
						{
							"id": "1009",
							"type": "Strawberry"
						}
					]
				},
				"topping": [{
						"id": "5001",
						"type": "None"
					},
					{
						"id": "5002",
						"type": "Glazed"
					},
					{
						"id": "5012",
						"type": "Lemon"
					},
					{
						"id": "5005",
						"type": "Sugar"
					},
					{
						"id": "5007",
						"type": "Powdered Sugar"
					},
					{
						"id": "5006",
						"type": "Chocolate with Sprinkles"
					},
					{
						"id": "5003",
						"type": "Chocolate"
					},
					{
						"id": "5008",
						"type": "White Chocolate"
					}
				],
				"nutrition_facts": {
					"nutrition": {
						"calories": 445,
						"fat": {
							"daily_value": "22%",
							"fat_type": {
								"saturated": "7.5g",
								"trans": "1.8g"
							}
						},
						"cholesterol": {
							"daily_value": "19%",
							"amount": "22mg"
						},
						"sodium": {
							"daily_value": "15%",
							"amount": "280mg"
						},
						"carbohydrate": {
							"daily_value": "12%",
							"carbs_detail": {
								"amount": "32 g",
								"type": {
									"fibre": "10g",
									"sugars": "45g"
								}
							}
						},
						"proteine": "13g",
						"vitamines": [{
								"type": "Vitamin A",
								"percent": "0%"
							},
							{
								"type": "Vitamin C",
								"percent": "0%"
							},
							{
								"type": "Calcium",
								"percent": "2%"
							},
							{
								"type": "Iron",
								"percent": "6%"
							}
						]
					}
				}
			},
			{
				"id": "0003",
				"type": "donut",
				"name": "Magic Fusion",
				"ppu": 0.67,
				"batters": {
					"batter": [{
							"id": "1001",
							"type": "Regular"
						},
						{
							"id": "1002",
							"type": "Chocolate"
						},
						{
							"id": "1003",
							"type": "Blueberry"
						},
						{
							"id": "1004",
							"type": "Devil's Food"
						},
						{
							"id": "1005",
							"type": "Mint"
						},
						{
							"id": "1006",
							"type": "Gluten-free"
						},
						{
							"id": "1009",
							"type": "Strawberry"
						}
					]
				},
				"topping": [{
						"id": "5001",
						"type": "None"
					},
					{
						"id": "5002",
						"type": "Glazed"
					},
					{
						"id": "5005",
						"type": "Sugar"
					},
					{
						"id": "5007",
						"type": "Powdered Sugar"
					},
					{
						"id": "5006",
						"type": "Chocolate with Sprinkles"
					},
					{
						"id": "5003",
						"type": "Chocolate"
					},
					{
						"id": "5004",
						"type": "Maple"
					},
					{
						"id": "5008",
						"type": "White Chocolate"
					}
				],
				"nutrition_facts": {
					"nutrition": {
						"calories": 395,
						"fat": {
							"daily_value": "10%",
							"fat_type": {
								"saturated": "9.5g",
								"trans": "1.8g"
							}
						},
						"cholesterol": {
							"daily_value": "22%",
							"amount": "22 mg"
						},
						"sodium": {
							"daily_value": "15%",
							"amount": "280 mg"
						},
						"carbohydrate": {
							"daily_value": "46%",
							"carbs_detail": {
								"amount": "32 g",
								"type": {
									"fibre": "1g",
									"sugars": "55g"
								}
							}
						},
						"proteine": "11g",
						"vitamines": [{
								"type": "Vitamin A",
								"percent": "0%"
							},
							{
								"type": "Vitamin C",
								"percent": "0%"
							},
							{
								"type": "Calcium",
								"percent": "2%"
							},
							{
								"type": "Iron",
								"percent": "8%"
							}
						]
					}
				}
			},
			{
				"id": "0004",
				"type": "donut",
				"name": "Black Mockaroo",
				"ppu": 0.58,
				"batters": {
					"batter": [{
							"id": "1001",
							"type": "Regular"
						},
						{
							"id": "1003",
							"type": "Blueberry"
						},
						{
							"id": "1004",
							"type": "Devil's Food"
						},
						{
							"id": "1007",
							"type": "Peanut"
						},
						{
							"id": "1006",
							"type": "Gluten-free"
						}
					]
				},
				"topping": [{
						"id": "5001",
						"type": "None"
					},
					{
						"id": "5002",
						"type": "Glazed"
					},
					{
						"id": "5005",
						"type": "Sugar"
					},
					{
						"id": "5007",
						"type": "Powdered Sugar"
					},
					{
						"id": "5006",
						"type": "Chocolate with Sprinkles"
					},
					{
						"id": "5009",
						"type": "Extra crunchy"
					},
					{
						"id": "5008",
						"type": "White Chocolate "
					}
				],
				"nutrition_facts": {
					"nutrition": {
						"calories": 485,
						"fat": {
							"daily_value": "14%",
							"fat_type": {
								"saturated": "7.5g",
								"trans": "3.3g"
							}
						},
						"cholesterol": {
							"daily_value": "12%",
							"amount": "19mg"
						},
						"sodium": {
							"daily_value": "25%",
							"amount": "299mg"
						},
						"carbohydrate": {
							"daily_value": "9%",
							"carbs_detail": {
								"amount": "16g",
								"type": {
									"fibre": "13g",
									"sugars": "28g"
								}
							}
						},
						"proteine": "11g",
						"vitamines": [{
								"type": "Vitamin A",
								"percent": "5"
							},
							{
								"type": "Vitamin C",
								"percent": "2%"
							},
							{
								"type": "Calcium",
								"percent": "2%"
							},
							{
								"type": "Iron",
								"percent": "8%"
							}
						]
					}
				}
			},
			{
				"id": "0005",
				"type": "donut",
				"name": "Relaxing Alchemy",
				"ppu": 0.78,
				"batters": {
					"batter": [{
						"id": "1006",
						"type": "Gluten-free"
					}]
				},
				"topping": [{
						"id": "5001",
						"type": "None"
					},
					{
						"id": "5022",
						"type": "Orange"
					},
					{
						"id": "5025",
						"type": "Melon"
					},
					{
						"id": "5027",
						"type": "Banana"
					},
					{
						"id": "5028",
						"type": "Watermelon"
					}
				],
				"nutrition_facts": {
					"nutrition": {
						"calories": 625,
						"fat": {
							"daily_value": "38%",
							"fat_type": {
								"saturated": "15.5g",
								"trans": "12.3g"
							}
						},
						"cholesterol": {
							"daily_value": "78%",
							"amount": "125 mg"
						},
						"sodium": {
							"daily_value": "35%",
							"amount": "580 mg"
						},
						"carbohydrate": {
							"daily_value": "56%",
							"carbs_detail": {
								"amount": "47g",
								"type": {
									"fibre": "1g",
									"sugars": "64g"
								}
							}
						},
						"proteine": "31g",
						"vitamines": [{
								"type": "Vitamin A",
								"percent": "0.3%"
							},
							{
								"type": "Vitamin C",
								"percent": "0.6%"
							},
							{
								"type": "Calcium",
								"percent": "2%"
							},
							{
								"type": "Iron",
								"percent": "18%"
							}
						]
					}
				}
			}
		]
	}
}

/* 
1.- Nuestro grupo se encuentra totalmente debilitado. Necesitamos tomar azúcares, hierro, proteínas y poca fibra. Para ello debemos preparar un conjuro que nos muestre:

donut con más azúcar (+ 50 exp)

donut con más hierro (+ 50 exp)

donut con más proteína (+ 50 exp)

donut con menos fibra (+ 50 exp)

*/

function showHighestDonuts()
{
	let highestProtein = 0;
	let highestSugar = 0;
	let leatFibre = parseInt(data.items.item[0].nutrition_facts.nutrition.carbohydrate.carbs_detail.type.fibre) // convertimos el string a un numero
	let highestIron = 0;
	
	let donutNameProtein;
	let donutNameSugar;
	let donutNameIron;
	let donutNamefibre;
	
	
	
	for (const key in data.items.item) {
		
			
		let proteinNum = parseInt(data.items.item[key].nutrition_facts.nutrition.proteine) // convertimos el string a un numero
		let sugarNum = parseInt(data.items.item[key].nutrition_facts.nutrition.carbohydrate.carbs_detail.type.sugars) // convertimos el string a un numero
		let fibreNum = parseInt(data.items.item[key].nutrition_facts.nutrition.carbohydrate.carbs_detail.type.fibre) // convertimos el string a un numero
		let ironNum = parseInt(data.items.item[key].nutrition_facts.nutrition.vitamines[3].percent) // convertimos el string a un numero
	

		let drawFibre = []; // array por si se dan varios casos
		console.log(ironNum);
		
		if (highestProtein < proteinNum) //hacemos comprobacion con el numero mas grande conseguido y el actual.
		{					
			donutNameProtein = data.items.item[key].name	// si entramos en la condicion conseguimos los datos
			highestProtein = proteinNum;	
		}
		if (highestSugar < sugarNum) 
		{	
			donutNameSugar = data.items.item[key].name
			highestSugar = sugarNum;	
		}
		if (leatFibre > fibreNum) // relaxing alchemy and hell cake have the same amount
		{	
			donutNamefibre = data.items.item[key].name
			leatFibre = fibreNum;	
			
		}
		if (highestIron < ironNum) 
		{	
			donutNameIron = data.items.item[key].name
			highestIron = ironNum;	
		}
	}
	
	console.log("the highest protein donut is " + donutNameProtein + " with : " + highestProtein + "g");	// imprimimos enunciado
	console.log("the highest sugar donut is " + donutNameSugar + " with : " + highestSugar + "g");
	console.log("the Least fibre donut is " + donutNamefibre + " with : " + leatFibre + "g");
	console.log("the highest iron percentage donut is " + donutNameIron + " with : " + highestIron + "%");
	
}

function showDonutsUpdated()
{
	let highestProtein = 0;
	let highestSugar = 0;
	let leastFibre = parseInt(data.items.item[0].nutrition_facts.nutrition.carbohydrate.carbs_detail.type.fibre) || Number.MAX_SAFE_INTEGER;
	let highestIron = 0;

	let donutNamesProtein = [];
	let donutNamesSugar = [];
	let donutNamesIron = [];
	let donutNamesFibre = [];

	for (const key in data.items.item) {

		let proteinNum = parseInt(data.items.item[key].nutrition_facts.nutrition.proteine) || 0; // Convertimos el string a un número o lo establecemos en 0 si no es válido
		let sugarNum = parseInt(data.items.item[key].nutrition_facts.nutrition.carbohydrate.carbs_detail.type.sugars) || 0;
		let fibreNum = parseInt(data.items.item[key].nutrition_facts.nutrition.carbohydrate.carbs_detail.type.fibre) || Number.MAX_SAFE_INTEGER;
		let ironNum = parseInt(data.items.item[key].nutrition_facts.nutrition.vitamines[3].percent) || 0; 
		//comparaciones
		if (proteinNum > highestProtein) {
			highestProtein = proteinNum;
			donutNamesProtein = [data.items.item[key].name]; // Reiniciamos la lista con el nuevo más alto
		} else if (proteinNum === highestProtein) {
			donutNamesProtein.push(data.items.item[key].name); // Agregamos si es un empate
		}

		if (sugarNum > highestSugar) {
			highestSugar = sugarNum;
			donutNamesSugar = [data.items.item[key].name]; 
		} else if (sugarNum === highestSugar) {
			donutNamesSugar.push(data.items.item[key].name);
		}

		if (fibreNum < leastFibre) {
			leastFibre = fibreNum;
			donutNamesFibre = [data.items.item[key].name];
		} else if (fibreNum === leastFibre) {
			donutNamesFibre.push(data.items.item[key].name);
		}

		if (ironNum > highestIron) {
			highestIron = ironNum;
			donutNamesIron = [data.items.item[key].name]; 
		} else if (ironNum === highestIron) {
			donutNamesIron.push(data.items.item[key].name);
		}
	}

	console.log("The highest protein donuts are: " + donutNamesProtein.join(", ") + " with: " + highestProtein + "g");
	console.log("The highest sugar donuts are: " + donutNamesSugar.join(", ") + " with: " + highestSugar + "g");
	console.log("The least fibre donuts are: " + donutNamesFibre.join(", ") + " with: " + leastFibre + "g");
	console.log("The highest iron percentage donuts are: " + donutNamesIron.join(", ") + " with: " + highestIron + "%");

}
/* 
2.- Necesitamos saber si la ingesta de calorías, grasas y carbohidratos puede mellar nuestra agilidad por lo que necesitamos:

	Listar todos los donuts y sus calorías (+ 50 exp)

	Listar todos los donuts y sus carbohidratos (+ 50 exp)

	Mostrar la media de calorías de todos los donuts (+ 50 exp)

	Mostrar la suma de las grasas saturadas de todos los donuts (+ 50 exp)

	Mostrar el porcentaje medio de cada vitamina (+ 50 exp)

*/

listDonuts();

function listDonuts()
{

	for (const key in data.items.item) {
		
		let calories = data.items.item[key].nutrition_facts.nutrition.calories;
		console.log(data.items.item[key].name + " has " + calories +" calories");
		
	}

	for (const key in data.items.item) {
		
		let carbohydrates = data.items.item[key].nutrition_facts.nutrition.carbohydrate.carbs_detail;
		console.log(data.items.item[key].name + " has ");
		console.log(carbohydrates);
		
		
	}

	donutMedia();
	showVitamines();
}

function donutMedia()
{
	let totalCal = 0;
	let totalDonuts = 0;
	let grasas = 0;
	for (const key in data.items.item) {
		
		totalCal += data.items.item[key].nutrition_facts.nutrition.calories
		grasas += parseFloat(data.items.item[key].nutrition_facts.nutrition.fat.fat_type.saturated)
		totalDonuts++;
	}
	let media = totalCal / totalDonuts;
	
	console.log("la media de calorias entre todos los donuts (" + totalDonuts + ") es de " + media + " calorias");
	console.log("la cantidad total de grasas saturadas en " + totalDonuts + " donuts es de " + grasas + "g");	

}

function showVitamines()
{
	let vitamineCtotal = 0;		// todo en porcentajes
	let vitamineAtotal = 0;
	let calciumtotal = 0;
	let ironTotal = 0;

	let donutsTotal = 0;

	for (const key in data.items.item) {
		
		// console.log("Las vitaminas de el donut " + data.items.item[key].name + " son las siguientes:");
		// console.log(data.items.item[key].nutrition_facts.nutrition.vitamines);
		// let vitamineTotal = 0;
	
		// for (let i = 0; i < data.items.item.nutrition_facts.nutrition.vitamines.length; i++) 
		// {
		// 	vitamineTotal +=  parseFloat(data.items.item[key].nutrition_facts.nutrition.vitamines[i].percent)
		// }
		// for (const vit in data.items.item.nutrition_facts.nutrition.vitamines) {
		// }

		// console.log("la media de '" + data.items.item[key].nutrition_facts.nutrition.vitamines[donutsTotal].type + "' es de " );
		

		vitamineAtotal 	+= parseFloat(data.items.item[key].nutrition_facts.nutrition.vitamines[0].percent)
		vitamineCtotal 	+= parseFloat(data.items.item[key].nutrition_facts.nutrition.vitamines[1].percent)
		calciumtotal	+= parseFloat(data.items.item[key].nutrition_facts.nutrition.vitamines[2].percent)
		ironTotal	 	+= parseFloat(data.items.item[key].nutrition_facts.nutrition.vitamines[3].percent)

		donutsTotal++;
	}

	let mediaVitC = vitamineCtotal / donutsTotal;
	let mediaVitA = vitamineAtotal / donutsTotal;
	let mediaCal = calciumtotal / donutsTotal;
	let mediaIron = ironTotal / donutsTotal;

	console.log("La media de vitamina C es de: " + mediaVitC + "%");
	console.log("La media de vitamina A es de: " + mediaVitA + "%");
	console.log("La media de Calcio es de: " + mediaCal + "%");
	console.log("La media de hierro es de: " + mediaIron + "%");

	// console.log(data.items.item.length);
	

	
}